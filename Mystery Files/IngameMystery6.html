<!DOCTYPE html>
<html lang="en">

<head> //LEVEL7 
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mystery</title>
    <link rel="stylesheet" href="IngameMystery.css">
    <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Russo+One&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Bungee+Inline&family=Russo+One&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Courier+Prime:ital,wght@0,400;0,700;1,400;1,700&display=swap" rel="stylesheet">
</head>

<body>
    <div class="homeheader">
        <h1>CodeCraft</h1>
        <h2>by </h2>
        <h3>CyberPink</h3>
    </div>

<div id="pixel-art-container2">
        <img id="img135" src="lvl8final1.png" class="pixel-art-frame active">
        <img id="img136" src="lvl8final2.png" class="pixel-art-frame">
        <img id="img137" src="lvl8final3.png" class="pixel-art-frame">
        <img id="img138" src="lvl8final4.png" class="pixel-art-frame">
        <img id="img139" src="lvl8final5.png" class="pixel-art-frame">
        <img id="img140" src="lvl8final6.png" class="pixel-art-frame">
        <img id="img141" src="lvl8final7.png" class="pixel-art-frame">
        <img id="img142" src="level8FinalStop.png" class="pixel-art-frame">
        <img id="img143" src="lvl8final8.png" class="pixel-art-frame">
        <img id="img144" src="lvl8final9.png" class="pixel-art-frame">
        <img id="img145" src="lvl8final10.png" class="pixel-art-frame">
        <img id="img146" src="lvl8final11.png" class="pixel-art-frame">
        <img id="img147" src="lvl8final12.png" class="pixel-art-frame">
        <img id="img148" src="lvl8final13.png" class="pixel-art-frame" style="display:none">
        <img id="img149" src="lvl8final14.png" class="pixel-art-frame">
        <img id="img150" src="lvl8final15.png" class="pixel-art-frame">
        <img id="img151" src="lvl8final16.png" class="pixel-art-frame">

        <div class="buttons">
            <button type="reset" class="button1" onclick="resetForm()">Reset</button>
            <button type="button" class="button2" onclick="undoInput()">Undo</button>
            <button type="button" class="button3" onclick="showHint()">Hint</button>
        </div>
    
        <div id="score-container">
            <p>Score: <span id="score">0</span></p>
        </div>
    
        <div id="hintBox" style="display:none;">
            <p id="hintText"></p>
        </div>

        <div class="form">
            <form id="answerForm" onsubmit="checkAnswer29(); return false;">
                <input type="text" id="textbox" name="textbox" placeholder="Enter your answer here: " oninput="updateSentence29();"><br>
                <span id="output" style="font-size: 14px;"></span><br>
                <input type="submit" value="Submit" id="submitbutton">
            </form>
        </div>
</div>
    
            <div class="text-box">
                <div id="sentence27" class="sentence show">
                    The fate of this investigation rests in your hands. Identify the killer or risk losing the case forever.
                    <br><br></div>
                <div id="sentence28" class="sentence"> Hurry!
                    <br><br></div>
                    <div id="sentence29" class="sentence"> 
                        import random <br>
                        suspects = ["Maria", "Berna", "Lee", "Jake"]<br>
                        correct_suspect = _______________ <br>
                        guess_attempts = 0<br>
                        found = False<br>
                        while not found:<br>
                            guess = random.choice(suspects)<br>
                            guess_attempts += 1<br>
                            if guess == correct_suspect:<br>
                                found = True<br>
                                print(f"Correct suspect '{correct_suspect}' guessed in {guess_attempts} attempts.")<br>
                            else:
                                print(f"Attempt {guess_attempts}: Guessed '{guess}', which is incorrect.")<br>
                        
                    <br><br> 
            </div>
                    <div id="sentence30" class="sentence"> <br><br>Congratulations Detective.</div>
                </div>

            <div id="toast" class="toast">
                <img src="Ranking (1)6.png" alt="Toast Image">
            </div>

    <script>
            document.addEventListener("DOMContentLoaded", function () {
                const container = document.getElementById('pixel-art-container2');
                const button1 = document.querySelector('.button1');
                const button2 = document.querySelector('.button2');
                const button3 = document.querySelector('.button3');
                const scores = document.getElementById('score-container');
                const hinting = document.getElementById('hintBox');
                let hintIndex = 0;
                const hints = [
                "Hint 1: It's really not that hard. Think again. Who could it be?",
                "Hint 2: Okay, this is getting embarrassing for the both of us.",
                "Hint 3: Fine! The main suspect has a three letter name."];
            
                function updateButtonPositions() {
                const containerRect = container.getBoundingClientRect();
                
                button1.style.left = `${containerRect.left + -430}px`;
                button1.style.top = `${containerRect.top + 510}px`; //Reset

                button2.style.left = `${containerRect.left + -430}px`;
                button2.style.top = `${containerRect.top + 470}px`; //Undo

                button3.style.left = `${containerRect.left + 660}px`;
                button3.style.top = `${containerRect.top + 510}px`; // Hint

                scores.style.left = `${containerRect.left + -500}px`;
                scores.style.top = `${containerRect.top + 5}px`; // Score Board

                hinting.style.left = `${containerRect.left + 710}px`;
                hinting.style.top = `${containerRect.top + 340}px`; // Hints na talaguh
            }

                updateButtonPositions();
                window.addEventListener('resize', updateButtonPositions);
                window.addEventListener('scroll', updateButtonPositions);
    
    let currentFrameIndex = 0;
    let interval = 1000;
    const frames2 = container.querySelectorAll(".pixel-art-frame");
    let animationInterval;

    function showNextFrame(frames) {
        frames[currentFrameIndex].classList.remove("active");
        currentFrameIndex = (currentFrameIndex + 1) % frames.length;
        frames[currentFrameIndex].classList.add("active");

        // Stop the animation when reaching the last frame
        if (frames[currentFrameIndex].id === 'img142') {
            clearInterval(animationInterval);
        }
    }

    setTimeout(() => {
        startAnimation(frames2); 
    }, 3000);

    function startAnimation(frames) {
        currentFrameIndex = 0;
        frames[currentFrameIndex].classList.add("active");
        animationInterval = setInterval(() => showNextFrame(frames), interval);
    }

    function displayRemainingFrames() {
    clearInterval(animationInterval);

    const remainingFrames = [
        document.getElementById("img149"),
        document.getElementById("img150"),
        document.getElementById("img151")
    ];

    let remainingIndex = 0;
    const remainingInterval = 18000;

    function showNextRemainingFrame() {
        remainingFrames[remainingIndex].classList.remove("active");
        remainingIndex++;
        
        if (remainingIndex < remainingFrames.length) {
            remainingFrames[remainingIndex].classList.add("active");
            if (remainingFrames[remainingIndex].id === 'img151') {
                clearInterval(remainingAnimationInterval);
            }
        }
    }

    remainingFrames[0].classList.add("active");
    const remainingAnimationInterval = setInterval(showNextRemainingFrame, remainingInterval);
}

    setTimeout(() => {
                document.getElementById("sentence27").style.display = "block";
                document.getElementById("sentence27").classList.add("show");
              }, 4000); 

    setTimeout(() => {
              document.getElementById("sentence28").style.display = "block";
              document.getElementById("sentence28").classList.add("show");
              }, 8000); 

    setTimeout(() => {
              document.getElementById("sentence29").style.display = "block";
              document.getElementById("sentence29").classList.add("show");
              }, 8000); 


const scoreElement = document.getElementById('score');
function getScore() {
  const score = localStorage.getItem("score");
  return score ? parseInt(score, 10) : 0;
};

function updateScore(newScore) {
  localStorage.setItem("score", newScore);
  scoreElement.textContent = newScore;
};

let score = getScore();
scoreElement.textContent = score;

let newScore = getScore();

window.checkAnswer29 = function() {
  var userInput = document.getElementById("textbox").value.trim().toLowerCase();
  var sentence29 = document.getElementById("sentence29");
  var correctAnswer = "lee";
  var spanClass = userInput === correctAnswer ? 'correct' : 'incorrect';

        if (userInput === correctAnswer) {
            newScore = score + 20; 
            updateScore(newScore);
            sentence29.innerHTML = "import random <br> " + " suspects = ['Maria', 'Berna', 'Lee', 'Jake'] <br>" + 
            "correct_suspect = " + "<span class='" + spanClass + "'>" + userInput + "</span>  <br>" + "guess_attempts = 0<br> " +
           "found = False<br>" + "while not found:<br>" + " guess = random.choice(suspects)<br>" + "guess_attempts += 1<br>"
           + "if guess == correct_suspect:<br>" + "found = True<br>" + 
           "print(f'Correct suspect '{correct_suspect}' guessed in {guess_attempts} attempts.'')else:" + 
           " print(f'Attempt {guess_attempts}: Guessed '{guess}', which is incorrect.'')<br>"
                document.getElementById("textbox").disabled = true;
                document.getElementById("submitbutton").disabled = true;
                showToast();

                setTimeout(() => {
                document.getElementById("img148").style.display = "block";
                document.getElementById("img148").classList.add("active");
                }, 1000);

                setTimeout(() => {
                    displayRemainingFrames()
                }, 5000);
                
                setTimeout(() => {
                    document.getElementById("sentence30").style.display = "block";
                    document.getElementById("sentence30").classList.add("show");
                }, 2000);

            setTimeout(() => {
                window.location.href = 'Ingamemystery6.html'; 
            }, 8000)

        } else {
        sentence29.innerHTML = "import random <br> " + " suspects = ['Maria', 'Berna', 'Lee', 'Jake']<br>" + 
        "correct_suspect = " + "<span class='" + spanClass + "'>" + userInput + "</span> <br>" + "guess_attempts = 0<br> " +
        "found = False<br>" + "while not found:<br>" + " guess = random.choice(suspects)<br>" + "guess_attempts += 1<br>"
        + "if guess == correct_suspect:<br>" + "found = True<br>" + 
        "print(f'Correct suspect '{correct_suspect}' guessed in {guess_attempts} attempts.'')else:" + 
        " print(f'Attempt {guess_attempts}: Guessed '{guess}', which is incorrect.'')<br>"

        if (userInput === "berna") {
            document.getElementById("img146").style.display = "block";
            document.getElementById("img146").classList.add("active");
        } else if (userInput === "maria") {
            document.getElementById("img144").style.display = "block";
            document.getElementById("img144").classList.add("active");
        } else if (userInput === "jake") {
            document.getElementById("img145").style.display = "block";
            document.getElementById("img145").classList.add("active");
        }
    }
};

    console.log("Current Score:", score);
    console.log("New Score:", newScore);  

    window.updateSentence29 = function () {
        var userInput = document.getElementById("textbox").value.trim();
        var sentence29 = document.getElementById("sentence29");
        sentence29.innerHTML = "import random <br> " + " suspects = ['Maria', 'Berna', 'Lee', 'Jake']<br>" + 
            "correct_suspect = " + userInput + "</span> + "+ "guess_attempts = 0<br> " +
           "found = False<br>" + "while not found:<br>" + " guess = random.choice(suspects)<br>" + "guess_attempts += 1<br>"
           + "if guess == correct_suspect:<br>" + "found = True<br>" + 
           "print(f'Correct suspect '{correct_suspect}' guessed in {guess_attempts} attempts.'')else:" + 
           " print(f'Attempt {guess_attempts}: Guessed '{guess}', which is incorrect.'')<br>";
    };
            window.resetForm = function () {
                document.getElementById("answerForm").reset();
                sentence29.innerHTML = "import random <br> " + " suspects = ['Maria', 'Berna', 'Lee', 'Jake']<br>" + 
            "correct_suspect = ________ "+ "guess_attempts = 0<br> " + "found = False<br>" + "while not found:<br>" + 
            " guess = random.choice(suspects)<br>" + "guess_attempts += 1<br>"+ "if guess == correct_suspect:<br>" + 
            "found = True<br>" + "print(f'Correct suspect '{correct_suspect}' guessed in {guess_attempts} attempts.'')else:" + 
           " print(f'Attempt {guess_attempts}: Guessed '{guess}', which is incorrect.'')<br>";
            document.getElementById("textbox").disabled = false;
            document.getElementById("sentence30").style.display = "none";
            document.getElementById("sentence30").classList.remove("show");
            };

            window.undoInput = function () {
                var textbox = document.getElementById("textbox");
                textbox.value = textbox.value.slice(0, -1);
                updateSentence29();
            };

        window.showHint = function () {
            const hintBox = document.getElementById("hintBox");
            const hintText = document.getElementById("hintText");

            if (hintIndex < hints.length) {
                hintText.textContent = hints[hintIndex];
                hintBox.style.display = "block";
                hintIndex++;
            } else {
                hintText.textContent = "No more hints available.";
            }};

    function showToast() {
    var toast = document.getElementById("toast");
    toast.className = "toast show";
    setTimeout(function(){ toast.className = toast.className.replace("show", ""); }, 5000);
}
        });
        </script>
</body>

</html>